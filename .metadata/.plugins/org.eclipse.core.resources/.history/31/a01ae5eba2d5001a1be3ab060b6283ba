package Controllers;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import Entities.Movie;
import Repository.MovieRepo;

@RestController
public class MovieController {
	
	@Autowired
	MovieRepo repo;
	
	@CrossOrigin(origins = "*")
	@GetMapping("/all")
	public List<Movie> showAll(){
		List<Movie> record= repo.findAll();
		return record;
	}
	
	@PostMapping("/save")
	public String saveRecord(@RequestParam String id, @RequestParam String title, @RequestParam String chyrate, @RequestParam String review, @RequestParam String date, @RequestParam String  reviewed) {
		Movie x=new Movie();
		SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
		
		x.setTitle(title);
		x.setChyrate(Integer.parseInt(chyrate));
		x.setReview(review);
		x.setReleaseDate(dateFormat.parse(date));
		x.setReviewedDate(dateFormat.parse(reviewed));
		repo.save(x);
		
		return "Movie added!";
	}
	
	
	@CrossOrigin(origins = "*")
	@GetMapping("/save")
	public String saveRecord(@RequestParam String id, @RequestParam String name, @RequestParam String address) {
		Student s=new Student();
		s.setRegno(Integer.parseInt(id));
		s.setName(name);
		s.setAddress(address);
		repo.save(s);
		
		return "Record Saved - name was " + name;
	}
}
